# Are You Root

## Introduction

The description states:

> Can you get root access through this service and get the flag?

## Included Files

* `auth` - an amd64 executable.
* `flag.txt` - contains the flag you need to recover.
* `ld-2.27.so` - the loader you should use.
* `libc.so.6` - the libc you should use.

## Information Gathering

### Hint #1

> How large is your user?

## Solution

So this won't be one of our better write-ups, as we came back the the README
three weeks after finishing the challenge. The crux of this challenge, is that
we can create a `user` with a name that contains the authorization value we
need to match (`0x5`). This `malloc`s the memory required for the `user`
struct. We later `reset` to logout and `free` our user. We then login again,
with a shorter name this time. Since the size of the two `user` objects are the
same, the same heap chunk will be used. `free` doesn't zero the values the
pointer `user` points to, so there is a residual value left over in the new
`user->level`.

The developers could have avoided this by assigning `user->level` by default
instead of relying on the user to provide it with the command `set-auth`.

Anyway, we used the included `solve.py` script to get the flag:
`picoCTF{m3sS1nG_w1tH_tH3_h43p_4baeffe9}`.
