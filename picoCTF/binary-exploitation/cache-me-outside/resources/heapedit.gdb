set arch i386:x86-64
set endian little
file ../heapedit
target remote localhost:1234

# run the target with `qemu-x86_64-static -g 1234 ./heapedit`

b free
continue
# Note the address passed to free. This points to our flag! Should be 0x603800.

continue
# Note the address passed to free again. This points to our random string. Should be 0x603890.

# Here we are going to search for the head of the tcache. We can do that because we know what it should be pointing to (our random string, 0x603890).
step

# I don't know the exact addresses of the heap, so I made an educated guess based on the pointers we saw before.
find 0x0000000000600000, 0x0000000000700000, 0x603890

# Find should return one pattern found at 0x602088. This is the head of our tcache. Let's do a small experiment and modify the contents of this pointer to instead contain the address of our flag. This won't work on the networked binary, but will work locally in our debugger.
set* 0x602088=0x603800

continue

# From here, we don't need to change any other addresses. Enter 0 and 0 in the stdin prompt. You should still get the flag because we manually changed the head of the tcache in the debugger.


